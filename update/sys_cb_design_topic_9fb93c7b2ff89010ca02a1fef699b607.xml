<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sys_cb_design_topic">
    <sys_cb_design_topic action="INSERT_OR_UPDATE">
        <compiled_topic display_value="My Assigned Equipment">17b9f87b2ff89010ca02a1fef699b6d2</compiled_topic>
        <design_definition>{"type":"FlowTopic","triggers":[{"type":"Trigger","name":"195629a8792f4ebe8a7695b3f206b285","triggerType":"request","applicability":{"type":"Applicability","mode":"script","value":"true"},"id":"195629a8792f4ebe8a7695b3f206b285"}],"goals":[{"name":"primary","trigger_id":"195629a8792f4ebe8a7695b3f206b285","nodes":[{"type":"StartGoal","goal_id":"2110f4b44be44411a147761d5274de01","greeting_msg":{"type":"String","mode":"string","value":""},"id":"c322f6f72adf46ef9aca6221d8900745","name":"Start","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"TerminateGoal","goal_id":"2110f4b44be44411a147761d5274de01","confirmation_msg":{"type":"String","mode":"string","value":""},"id":"9ff6d43e1adb4564af830203aca17318","name":"End","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"ReferenceChoiceInputPrompt","mode":"external","id":"b7e3188a9c5243bf9942b119dfb8f072","name":"Assigned Asset","goal_id":"2110f4b44be44411a147761d5274de01","applicability":{"type":"Applicability","mode":"script","value":"true"},"variable_id":"b42e9c501e654c0382307d1764ddc0d2","message":{"type":"String","mode":"script","value":"(function execute() {\n    return gs.getMessage('You have {0} assigned assets.', vaVars.count);\n})()\n"},"optional":false,"nlu_entity_binding":{"type":"NLUEntityBinding","name":"","allow_text_input":false,"use_confirmation_prompt":true},"expression_mode":"script","script":"(function execute() {\n    var options = [];\n\n    // get variables\n    var index = parseInt(vaVars.index);\n    var limit = parseInt(vaVars.limit);\n    var count = 0;\n    \n    // query current and future planned outages \n    var gr = new GlideRecordSecure('alm_asset');\n    gr.addQuery('assigned_to', vaInputs.user);\n    gr.orderByDesc('sys_created_on'); \n    gr.chooseWindow(index, index + limit, true);\n    gr.query();  \n\n    // get total count, used for pagination\n    count = gr.getRowCount();\n    vaVars.count = count;\n\n    // page of outage records\n    var cnt = 0;\n    while(gr.next()) {\n        var value = gr.getUniqueValue();\n        var label = gr.getDisplayValue('model');\n        var assetTag = gr.getDisplayValue('asset_tag');\n\n        if (assetTag) {\n            label += ' [' + assetTag + ']';\n        }\n\n        options.push({ \n            'value': value,\n            'label': label\n        });\n\n        cnt++;\n    }\n\n    var totalPages = Math.ceil(count / limit).toString();\n    var currentPage = Math.ceil((index+1) / limit).toString();\n\n    // previous and next buttons\n    if ( index &gt; 0 &amp;&amp; cnt &gt; 0 ) {\n        options.push({ 'value': 'prev', 'label': gs.getMessage('Show previous')});\n    }\n    if ( count &gt; index + limit) {\n        options.push({ 'value': 'next', 'label': gs.getMessage('Show more')});\n    }\n    return options;\n})();","no_options_found_message":{"type":"String","mode":"string","value":"No Records Found"},"condition":{"type":"Condition","mode":"external_script","value":"(function execute() {\n    var options = [];\n\n    // get variables\n    var index = parseInt(vaVars.index);\n    var limit = parseInt(vaVars.limit);\n    var count = 0;\n    \n    // query current and future planned outages \n    var gr = new GlideRecordSecure('alm_asset');\n    gr.addQuery('assigned_to', vaInputs.user);\n    gr.orderByDesc('sys_created_on'); \n    gr.chooseWindow(index, index + limit, true);\n    gr.query();  \n\n    // get total count, used for pagination\n    count = gr.getRowCount();\n    vaVars.count = count;\n\n    // page of outage records\n    var cnt = 0;\n    while(gr.next()) {\n        var value = gr.getUniqueValue();\n        var label = gr.getDisplayValue('model');\n        var assetTag = gr.getDisplayValue('asset_tag');\n\n        if (assetTag) {\n            label += ' [' + assetTag + ']';\n        }\n\n        options.push({ \n            'value': value,\n            'label': label\n        });\n\n        cnt++;\n    }\n\n    var totalPages = Math.ceil(count / limit).toString();\n    var currentPage = Math.ceil((index+1) / limit).toString();\n\n    // previous and next buttons\n    if ( index &gt; 0 &amp;&amp; cnt &gt; 0 ) {\n        options.push({ 'value': 'prev', 'label': gs.getMessage('Show previous')});\n    }\n    if ( count &gt; index + limit) {\n        options.push({ 'value': 'next', 'label': gs.getMessage('Show more')});\n    }\n    return options;\n})();"}},{"type":"Decision","name":"Next Page","branches":[{"type":"Branch","label":"Show Asset","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return (vaInputs.assigned_asset.getValue() != 'next' &amp;&amp; vaInputs.assigned_asset.getValue() != 'prev' &amp;&amp; vaInputs.assigned_asset.getValue() != '');\n})();"},"id":"acbeb5f76ebd48a19c5882de237cb73b","name":"Show Asset"},{"type":"Branch","label":"Previous","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return (vaInputs.assigned_asset.getValue() == 'prev');\n})();"},"id":"c84a59b3b90e4ce0b6c127617854697a","name":"Previous"},{"type":"Branch","label":"Next","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return vaInputs.assigned_asset == 'next';\n})()"},"id":"1b90fad4716b46fa9e237594e17a3ac9","name":"Next"}],"id":"d3f9a18ae9734ca5be6873d84d061c83","goal_id":"2110f4b44be44411a147761d5274de01","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"ScriptedAction","script":"(function execute() {\n    var index = parseInt(vaVars.index);\n    var limit = parseInt(vaVars.limit);\n    var c = index - limit;\n    if ( c &lt; 0 ) c = 0;\n    vaVars.index = c;\n    return '';\n})()","id":"42d9b2025b114b88a51ac97b4a389aa6","name":"Previous Page","goal_id":"2110f4b44be44411a147761d5274de01","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"ScriptedAction","script":"(function execute() {\n\n    // query assets to get the updated count\n    var gr = new GlideRecordSecure('alm_asset');\n    gr.addQuery('assigned_to', vaInputs.user);\n    gr.orderByDesc('sys_created_on'); \n    gr.query();  \n\n    // get total count, to check for existence of next page\n    vaVars.count = gr.getRowCount();\n\n    // next page math\n    var count = parseInt(vaVars.count);\n    var index = parseInt(vaVars.index);\n    var limit = parseInt(vaVars.limit);\n    if ( index + limit &gt;= count )\n        vaVars.index = 0;\n    else\n        vaVars.index = index + limit;\n    return '';\n})();","id":"6e96913c953e45d586386a1f72beefa2","name":"Next Page","goal_id":"2110f4b44be44411a147761d5274de01","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"ScriptedAction","script":"(function execute() {\n    // reset to first page\n    vaVars.index = 0;\n\n    // count how many assets there are\n    var count = 0;\n    var gr = new GlideAggregate('alm_asset');\n    gr.addQuery('assigned_to', vaInputs.user);\n    gr.addAggregate('COUNT');\n    gr.query();\n    if (gr.next())\n        count = gr.getAggregate('COUNT');\n    \n    // set count variable\n    vaVars.count = count;\n})();","id":"24b6161583864238a9c2cbb3434807c3","name":"Check Assets","goal_id":"2110f4b44be44411a147761d5274de01","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"Decision","name":"Count Decision","branches":[{"type":"Branch","label":"Many Assets","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return vaVars.count &gt; 1;\n})()"},"id":"22b5004233ec48dcb8c9e0e1a9966e64","name":"Many Assets"},{"type":"Branch","label":"No Assets","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return vaVars.count == 0;\n})();"},"id":"05cce5734f3b418a832f5fb13fecc275","name":"No Assets"},{"type":"Branch","label":"One Asset","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return vaVars.count == 1;\n})();"},"id":"e9249782aba242afbbac0d38f0979183","name":"One Asset"}],"id":"cb223be9aef84727934ab66074d08cf1","goal_id":"2110f4b44be44411a147761d5274de01","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"OutputPrompt","value":{"type":"String","mode":"string","value":"gs.getMessageLang(\"You do not have any assigned assets.\", vaContext.getRequesterLang())"},"id":"fc73dcf725a14cd99fef2225bd1fc45c","name":"No Assets","goal_id":"2110f4b44be44411a147761d5274de01","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"OutputPrompt","value":{"type":"String","mode":"string","value":"gs.getMessageLang(\"You only have one assigned asset.\", vaContext.getRequesterLang())"},"id":"72f13e1d55e445e3978daad95ae0c529","name":"One Asset","goal_id":"2110f4b44be44411a147761d5274de01","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"RecordOutputPrompt","mode":"script","table":"alm_asset","script":"(function execute(table) {\n    var gr = new GlideRecord(table);\n    gr.addQuery('assigned_to', vaInputs.user);\n    gr.orderByDesc('sys_created_on');\n    gr.setLimit(1);\n    gr.query();\n    if(gr.next()) {\n        return gr;\n    }\n})(table);\n","fields":["asset_tag","display_name","model_category","vendor","cost","retirement_date"],"id":"35a66784ee284933b4d03d13fed9f064","name":"Display Single Asset","goal_id":"2110f4b44be44411a147761d5274de01","applicability":{"type":"Applicability","mode":"script","value":"true"},"condition":{"type":"Condition","mode":"glide_scripted_query","value":"(function execute(table) {\n    var gr = new GlideRecord(table);\n    gr.addQuery('assigned_to', vaInputs.user);\n    gr.orderByDesc('sys_created_on');\n    gr.setLimit(1);\n    gr.query();\n    if(gr.next()) {\n        return gr;\n    }\n})(table);\n"}},{"type":"RecordOutputPrompt","mode":"script","table":"alm_asset","script":"(function execute(table) {\n    var gr = new GlideRecord(table);\n    gr.get(vaInputs.assigned_asset);\n    if(gr) {\n        return gr;\n    }\n})(table);\n","fields":["asset_tag","model_category","vendor","cost","retirement_date"],"id":"3edfda162286441999b70e1cd4e2de21","name":"Render Asset Details","goal_id":"2110f4b44be44411a147761d5274de01","applicability":{"type":"Applicability","mode":"script","value":"true"},"condition":{"type":"Condition","mode":"glide_scripted_query","value":"(function execute(table) {\n    var gr = new GlideRecord(table);\n    gr.get(vaInputs.assigned_asset);\n    if(gr) {\n        return gr;\n    }\n})(table);\n"}}],"edges":[{"type":"Edge","source_node_id":"3edfda162286441999b70e1cd4e2de21","target_node_id":"9ff6d43e1adb4564af830203aca17318","id":"c7014d70f4a44ab2a3e5204c01701ec9"},{"type":"Edge","source_node_id":"72f13e1d55e445e3978daad95ae0c529","target_node_id":"35a66784ee284933b4d03d13fed9f064","id":"31af37c3347b417faf65c034d2a2f6e3"},{"type":"Edge","source_node_id":"d3f9a18ae9734ca5be6873d84d061c83","target_node_id":"3edfda162286441999b70e1cd4e2de21","branch_id":"acbeb5f76ebd48a19c5882de237cb73b","id":"bed02fa32f1d485395df5184ea3801cc","name":"acbeb5f76ebd48a19c5882de237cb73b"},{"type":"Edge","source_node_id":"cb223be9aef84727934ab66074d08cf1","target_node_id":"b7e3188a9c5243bf9942b119dfb8f072","branch_id":"22b5004233ec48dcb8c9e0e1a9966e64","id":"a16ebcb3064d4e5385f8206d5a05f19b","name":"22b5004233ec48dcb8c9e0e1a9966e64"},{"type":"Edge","source_node_id":"b7e3188a9c5243bf9942b119dfb8f072","target_node_id":"d3f9a18ae9734ca5be6873d84d061c83","id":"1836cab4db144171b3e3966c2c9d3184"},{"type":"Edge","source_node_id":"d3f9a18ae9734ca5be6873d84d061c83","target_node_id":"42d9b2025b114b88a51ac97b4a389aa6","branch_id":"c84a59b3b90e4ce0b6c127617854697a","id":"2d454d0198ba42bfb8b8dde176bf2951","name":"c84a59b3b90e4ce0b6c127617854697a"},{"type":"Edge","source_node_id":"42d9b2025b114b88a51ac97b4a389aa6","target_node_id":"b7e3188a9c5243bf9942b119dfb8f072","id":"ae8c2d0f53474a2391fa45aae9101a7f"},{"type":"Edge","source_node_id":"d3f9a18ae9734ca5be6873d84d061c83","target_node_id":"6e96913c953e45d586386a1f72beefa2","branch_id":"1b90fad4716b46fa9e237594e17a3ac9","id":"ff415f4d864b4d518ea34294c33ae965","name":"1b90fad4716b46fa9e237594e17a3ac9"},{"type":"Edge","source_node_id":"6e96913c953e45d586386a1f72beefa2","target_node_id":"b7e3188a9c5243bf9942b119dfb8f072","id":"48b83a409b5d4607a2e51b76e9563f3a"},{"type":"Edge","source_node_id":"c322f6f72adf46ef9aca6221d8900745","target_node_id":"24b6161583864238a9c2cbb3434807c3","id":"04051e9d30a74532b4e150cb105216e0"},{"type":"Edge","source_node_id":"24b6161583864238a9c2cbb3434807c3","target_node_id":"cb223be9aef84727934ab66074d08cf1","id":"494cecc3baf140529c5ae83e17765807"},{"type":"Edge","source_node_id":"cb223be9aef84727934ab66074d08cf1","target_node_id":"fc73dcf725a14cd99fef2225bd1fc45c","branch_id":"05cce5734f3b418a832f5fb13fecc275","id":"b8f0b384445448039b79a51c5c5c764a","name":"05cce5734f3b418a832f5fb13fecc275"},{"type":"Edge","source_node_id":"fc73dcf725a14cd99fef2225bd1fc45c","target_node_id":"9ff6d43e1adb4564af830203aca17318","id":"022a4f9a59ed4a6ca8709707d51a1f91"},{"type":"Edge","source_node_id":"cb223be9aef84727934ab66074d08cf1","target_node_id":"72f13e1d55e445e3978daad95ae0c529","branch_id":"e9249782aba242afbbac0d38f0979183","id":"e990340fe5564dc68b18c12ea2b9e455","name":"e9249782aba242afbbac0d38f0979183"},{"type":"Edge","source_node_id":"35a66784ee284933b4d03d13fed9f064","target_node_id":"9ff6d43e1adb4564af830203aca17318","id":"a241ee149d814d8ea02eb48e096f41c6"}],"id":"2110f4b44be44411a147761d5274de01"}],"script_variables":[{"type":"String","name":"limit","value":{"type":"String","mode":"string","value":"5"},"id":"b8a43039dacd47d8a82696675f7ea2b5"},{"type":"String","name":"count","value":{"type":"String","mode":"string","value":"0"},"id":"f3a8bb09ae914d398c504cc8af6709af"},{"type":"String","name":"index","value":{"type":"String","mode":"string","value":"0"},"id":"260d9b3dc5ba4094bfcdc81708205f6b"},{"type":"String","name":"base_url","value":{"type":"String","mode":"script","value":"(function execute() {\n    return gs.getProperty('glide.servlet.uri') + '/';\n})();"},"id":"3d62f50238604bcf9c6a9ca94943125a"},{"type":"String","name":"LiveAgent_application","value":{"type":"String","mode":"string","value":"itsm"},"id":"ec68971f4e5545e09a0b90a9668cb556"},{"type":"String","name":"portal","value":{"type":"String","mode":"string","value":"sp"},"id":"d2a3c41e74c44943af92a7f1a316c0d2"}],"glide_variables":[{"type":"Choice","choices":[],"id":"b42e9c501e654c0382307d1764ddc0d2","name":"assigned_asset","table":""},{"type":"Reference","table":"sys_user","id":"current-user","name":"user"}],"applicability":{"type":"Applicability","mode":"script","value":"\n\t\t\t(function execute() {\n\t\t    \treturn GlidePluginManager.isActive('com.snc.asset_management');\n\t\t    })();\n\t\t"},"roles":[],"scope":"134450a0b3781300787162ac16a8dc1e","domain":"global","id":"729938c5b301130001182ab716a8dcb1","name":"My Assigned Equipment","key_phrases":["assigned asset","asset","hardware","hardware status","assigned","equipment","assigned equipment"],"nlu_provider":"","nlu_model":"sn_itsm_nlu_ITSM_NLU_for_VA","nlu_model_label":"","nlu_intent":"MyAssignedEquipment","nlu_intent_label":"","flexible_conversation_switching":false,"design_category":"3efd22da0b203300a1b16c2367673a10","library":false}</design_definition>
        <design_topic_id>729938c5b301130001182ab716a8dcb1</design_topic_id>
        <name>My Assigned Equipment</name>
        <sys_class_name>sys_cb_design_topic</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2020-05-22 09:46:11</sys_created_on>
        <sys_domain>global</sys_domain>
        <sys_id>9fb93c7b2ff89010ca02a1fef699b607</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>FlowTopic</sys_name>
        <sys_package display_value="NeedIt" source="x_58872_needit">6ead8e780f603200cd674f8ce1050ed1</sys_package>
        <sys_policy/>
        <sys_scope display_value="NeedIt">6ead8e780f603200cd674f8ce1050ed1</sys_scope>
        <sys_update_name>sys_cb_design_topic_9fb93c7b2ff89010ca02a1fef699b607</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2020-05-22 09:46:11</sys_updated_on>
        <type>FlowTopic</type>
    </sys_cb_design_topic>
</record_update>
